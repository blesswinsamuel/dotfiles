‚ùØ curl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install
info: downloading installer https://install.determinate.systems/nix/tag/v0.15.1/nix-installer-aarch64-darwin
`nix-installer` needs to run as `root`, attempting to escalate now via `sudo`...
Nix install plan (v0.15.1)
Planner: macos (with default settings)

Planned actions:
* Create an encrypted APFS volume `Nix Store` for Nix on `disk3` and add it to `/etc/fstab` mounting on `/nix`
* Fetch `https://releases.nixos.org/nix/nix-2.18.1/nix-2.18.1-aarch64-darwin.tar.xz` to `/nix/temp-install-dir`
* Create a directory tree in `/nix`
* Move the downloaded Nix into `/nix`
* Create build users (UID 300-332) and group (GID 30000)
* Configure Time Machine exclusions
* Setup the default Nix profile
* Place the Nix configuration in `/etc/nix/nix.conf`
* Configure the shell profiles
* Configuring zsh to support using Nix in non-interactive shells
* Create a `launchctl` plist to put Nix into your PATH
* Configure Nix daemon related settings with launchctl
* Remove directory `/nix/temp-install-dir`


Proceed? ([Y]es/[n]o/[e]xplain): e
Nix install plan (v0.15.1)
Planner: macos

Configured settings:
* case_sensitive: false
* diagnostic_endpoint: "https://install.determinate.systems/nix/diagnostic"
* extra_conf: []
* force: false
* modify_profile: true
* nix_build_group_id: 30000
* nix_build_group_name: "nixbld"
* nix_build_user_count: 32
* nix_build_user_id_base: 300
* nix_build_user_prefix: "_nixbld"
* nix_package_url: {"Url":"https://releases.nixos.org/nix/nix-2.18.1/nix-2.18.1-aarch64-darwin.tar.xz"}
* proxy: null
* root_disk: "disk3"
* ssl_cert_file: null
* volume_encrypt: null
* volume_label: "Nix Store"

Planned actions:
* Create an encrypted APFS volume `Nix Store` for Nix on `disk3` and add it to `/etc/fstab` mounting on `/nix`
  Create or insert file `/etc/synthetic.conf`
  Create objects defined in `/etc/synthetic.conf`
  Unmount the `Nix Store` APFS volume
  Create an APFS volume on `disk3` named `Nix Store`
  Add a UUID based entry for the APFS volume `Nix Store` to `/etc/fstab`
  Encrypt volume `Nix Store` on disk `disk3`
  Create a `launchctl` plist to mount the APFS volume `/Library/LaunchDaemons/org.nixos.darwin-store.plist`
  Bootstrap the `org.nixos.darwin-store` service via `launchctl bootstrap system /Library/LaunchDaemons/org.nixos.darwin-store.plist`
  Enable ownership on `/nix`
* Fetch `https://releases.nixos.org/nix/nix-2.18.1/nix-2.18.1-aarch64-darwin.tar.xz` to `/nix/temp-install-dir`
* Create a directory tree in `/nix`
  Create directory `/nix/var`
  Create directory `/nix/var/log`
  Create directory `/nix/var/log/nix`
  Create directory `/nix/var/log/nix/drvs`
  Create directory `/nix/var/nix`
  Create directory `/nix/var/nix/db`
  Create directory `/nix/var/nix/gcroots`
  Create directory `/nix/var/nix/gcroots/per-user`
  Create directory `/nix/var/nix/profiles`
  Create directory `/nix/var/nix/profiles/per-user`
  Create directory `/nix/var/nix/temproots`
  Create directory `/nix/var/nix/userpool`
  Create directory `/nix/var/nix/daemon-socket`
* Move the downloaded Nix into `/nix`
  Nix is being downloaded to `/nix/temp-install-dir` and should be in `/nix`
* Create build users (UID 300-332) and group (GID 30000)
  The Nix daemon requires system users (and a group they share) which it can act as in order to build
  Create group `nixbld` (GID 30000)
  Create user `_nixbld1` (UID 301) in group `nixbld` (GID 30000)
  Create user `_nixbld2` (UID 302) in group `nixbld` (GID 30000)
  Create user `_nixbld3` (UID 303) in group `nixbld` (GID 30000)
  Create user `_nixbld4` (UID 304) in group `nixbld` (GID 30000)
  Create user `_nixbld5` (UID 305) in group `nixbld` (GID 30000)
  Create user `_nixbld6` (UID 306) in group `nixbld` (GID 30000)
  Create user `_nixbld7` (UID 307) in group `nixbld` (GID 30000)
  Create user `_nixbld8` (UID 308) in group `nixbld` (GID 30000)
  Create user `_nixbld9` (UID 309) in group `nixbld` (GID 30000)
  Create user `_nixbld10` (UID 310) in group `nixbld` (GID 30000)
  Create user `_nixbld11` (UID 311) in group `nixbld` (GID 30000)
  Create user `_nixbld12` (UID 312) in group `nixbld` (GID 30000)
  Create user `_nixbld13` (UID 313) in group `nixbld` (GID 30000)
  Create user `_nixbld14` (UID 314) in group `nixbld` (GID 30000)
  Create user `_nixbld15` (UID 315) in group `nixbld` (GID 30000)
  Create user `_nixbld16` (UID 316) in group `nixbld` (GID 30000)
  Create user `_nixbld17` (UID 317) in group `nixbld` (GID 30000)
  Create user `_nixbld18` (UID 318) in group `nixbld` (GID 30000)
  Create user `_nixbld19` (UID 319) in group `nixbld` (GID 30000)
  Create user `_nixbld20` (UID 320) in group `nixbld` (GID 30000)
  Create user `_nixbld21` (UID 321) in group `nixbld` (GID 30000)
  Create user `_nixbld22` (UID 322) in group `nixbld` (GID 30000)
  Create user `_nixbld23` (UID 323) in group `nixbld` (GID 30000)
  Create user `_nixbld24` (UID 324) in group `nixbld` (GID 30000)
  Create user `_nixbld25` (UID 325) in group `nixbld` (GID 30000)
  Create user `_nixbld26` (UID 326) in group `nixbld` (GID 30000)
  Create user `_nixbld27` (UID 327) in group `nixbld` (GID 30000)
  Create user `_nixbld28` (UID 328) in group `nixbld` (GID 30000)
  Create user `_nixbld29` (UID 329) in group `nixbld` (GID 30000)
  Create user `_nixbld30` (UID 330) in group `nixbld` (GID 30000)
  Create user `_nixbld31` (UID 331) in group `nixbld` (GID 30000)
  Create user `_nixbld32` (UID 332) in group `nixbld` (GID 30000)
  Add user `_nixbld1` (UID 301) to group `nixbld` (GID 30000)
  Add user `_nixbld2` (UID 302) to group `nixbld` (GID 30000)
  Add user `_nixbld3` (UID 303) to group `nixbld` (GID 30000)
  Add user `_nixbld4` (UID 304) to group `nixbld` (GID 30000)
  Add user `_nixbld5` (UID 305) to group `nixbld` (GID 30000)
  Add user `_nixbld6` (UID 306) to group `nixbld` (GID 30000)
  Add user `_nixbld7` (UID 307) to group `nixbld` (GID 30000)
  Add user `_nixbld8` (UID 308) to group `nixbld` (GID 30000)
  Add user `_nixbld9` (UID 309) to group `nixbld` (GID 30000)
  Add user `_nixbld10` (UID 310) to group `nixbld` (GID 30000)
  Add user `_nixbld11` (UID 311) to group `nixbld` (GID 30000)
  Add user `_nixbld12` (UID 312) to group `nixbld` (GID 30000)
  Add user `_nixbld13` (UID 313) to group `nixbld` (GID 30000)
  Add user `_nixbld14` (UID 314) to group `nixbld` (GID 30000)
  Add user `_nixbld15` (UID 315) to group `nixbld` (GID 30000)
  Add user `_nixbld16` (UID 316) to group `nixbld` (GID 30000)
  Add user `_nixbld17` (UID 317) to group `nixbld` (GID 30000)
  Add user `_nixbld18` (UID 318) to group `nixbld` (GID 30000)
  Add user `_nixbld19` (UID 319) to group `nixbld` (GID 30000)
  Add user `_nixbld20` (UID 320) to group `nixbld` (GID 30000)
  Add user `_nixbld21` (UID 321) to group `nixbld` (GID 30000)
  Add user `_nixbld22` (UID 322) to group `nixbld` (GID 30000)
  Add user `_nixbld23` (UID 323) to group `nixbld` (GID 30000)
  Add user `_nixbld24` (UID 324) to group `nixbld` (GID 30000)
  Add user `_nixbld25` (UID 325) to group `nixbld` (GID 30000)
  Add user `_nixbld26` (UID 326) to group `nixbld` (GID 30000)
  Add user `_nixbld27` (UID 327) to group `nixbld` (GID 30000)
  Add user `_nixbld28` (UID 328) to group `nixbld` (GID 30000)
  Add user `_nixbld29` (UID 329) to group `nixbld` (GID 30000)
  Add user `_nixbld30` (UID 330) to group `nixbld` (GID 30000)
  Add user `_nixbld31` (UID 331) to group `nixbld` (GID 30000)
  Add user `_nixbld32` (UID 332) to group `nixbld` (GID 30000)
* Configure Time Machine exclusions
  Configure Time Machine exclusion on `/nix/store`
  Configure Time Machine exclusion on `/nix/var`
* Setup the default Nix profile
* Place the Nix configuration in `/etc/nix/nix.conf`
  This file is read by the Nix daemon to set its configuration options at runtime.
  Create directory `/etc/nix`
  Merge or create nix.conf file `/etc/nix/nix.conf`
* Configure the shell profiles
  Update shell profiles to import Nix
* Configuring zsh to support using Nix in non-interactive shells
  Update `/etc/zshenv` to import Nix
* Create a `launchctl` plist to put Nix into your PATH
* Configure Nix daemon related settings with launchctl
  Copy `/nix/var/nix/profiles/default/Library/LaunchDaemons/org.nixos.nix-daemon.plist` to `DARWIN_NIX_DAEMON_DEST`
  Run `launchctl load /Library/LaunchDaemons/org.nixos.nix-daemon.plist`
* Remove directory `/nix/temp-install-dir`


Proceed? ([Y]es/[n]o): Y
 INFO Step: Create an encrypted APFS volume `Nix Store` for Nix on `disk3` and add it to `/etc/fstab` mounting on `/nix`
 INFO Step: Provision Nix
 INFO Step: Create build users (UID 300-332) and group (GID 30000)
 INFO Step: Configure Time Machine exclusions
 INFO Step: Configure Nix
 INFO Step: Configuring zsh to support using Nix in non-interactive shells
 INFO Step: Create a `launchctl` plist to put Nix into your PATH
 INFO Step: Configure Nix daemon related settings with launchctl
 INFO Step: Remove directory `/nix/temp-install-dir`
Nix was installed successfully!
To get started using Nix, open a new shell or run `. /nix/var/nix/profiles/default/etc/profile.d/nix-daemon.fish`
